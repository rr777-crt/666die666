<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Карточная Игра</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 10px;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .game-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            background-color: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-size: 16px;
        }
        
        .blocks {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .block {
            width: 100px;
            height: 100px;
            background-color: #ddd;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .card {
            width: 90%;
            height: 90%;
            background-color: white;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            font-size: 14px;
        }
        
        .card.common {
            border: 2px solid #ccc;
            color: #333;
        }
        
        .card.rare {
            border: 2px solid #4da6ff;
            background-color: #e6f2ff;
            color: #003366;
        }
        
        .card.epic {
            border: 2px solid #b366ff;
            background-color: #f0e6ff;
            color: #4d0066;
        }
        
        .card.legendary {
            border: 2px solid #ff9900;
            background-color: #fff2cc;
            color: #663300;
        }

          .card.mythic {
            border: 2px solid #ff9900;
            background-color: red;
            color: #763300;
        }
        
        .card.divine {
            background: linear-gradient(45deg, #ff0000, #ff9900, #33cc33, #0099ff, #9933ff);
            background-size: 400% 400%;
            animation: rainbow 5s ease infinite;
            border: 2px solid gold;
            color: white;
            text-shadow: 0 0 3px black;
        }
        .card.secret {
            border: 2px solid #ff9900;
            background-color: black;
            color: #000000;
        }
        
        @keyframes rainbow {
            0% {background-position: 0% 50%}
            50% {background-position: 100% 50%}
            100% {background-position: 0% 50%}
        }
        
        .pack-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
            cursor: pointer;
            flex-grow: 1;
            font-size: 14px;
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .inventory {
            background-color: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-height: 200px;
            overflow-y: auto;
        }
        
        .inventory-title {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 5px;
        }
        
        .inventory-card {
            padding: 5px;
            border-radius: 3px;
            font-size: 12px;
            text-align: center;
            cursor: pointer;
            word-break: break-word;
            position: relative;
            transition: all 0.2s;
            user-select: none;
        }
        
        .inventory-card.selected {
            border: 2px solid green;
        }
        
        .inventory-card.selling {
            transform: scale(0.95);
            opacity: 0.8;
            border: 2px dashed red;
        }
        
        .hold-timer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background-color: #ff5722;
            transition: width 1s linear;
        }
        
        .upgrades {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .pack-opening {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: white;
        }
        
        .pack-card {
            width: 70%;
            max-width: 300px;
            height: 200px;
            background-color: white;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            transform: scale(0);
            animation: cardReveal 0.5s forwards;
            color: #333;
        }
        
        @keyframes cardReveal {
            to { transform: scale(1); }
        }
        
        .pack-info {
            margin-bottom: 20px;
            text-align: center;
            font-size: 18px;
        }
        
        .continue-btn {
            background-color: #4CAF50;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .placed-card {
            position: absolute;
            width: 90%;
            height: 90%;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="stats">
            <div>Монеты: <span id="money">15</span>¢</div>
            <div>Карты: <span id="total-cards">0</span>/<span id="max-cards">15</span></div>
        </div>
        
        <div class="blocks" id="blocks">
            <!-- Блоки будут добавлены динамически -->
        </div>
        
        <div class="pack-buttons">
            <button id="small-pack" onclick="buyPack('small')">Маленькая пачка (5¢)</button>
            <button id="big-pack" onclick="buyPack('big')">Большая пачка (50¢)</button>
            <button id="premium-pack" onclick="buyPack('premium')">Премиум пачка (500¢)</button>
             <button id="Ultra-pack" onclick="buyPack('Ultra')">Ультра пачка (50000¢)</button>
             <button id="OMEGA-pack" onclick="buyPack('OMEGA')">ОМЕГА пачка (4000000¢)</button>
             <button id="PPP-pack" onclick="buyPack('PPP')"> СЕКРЕТНАЯ пачка (1000000000¢)</button>
        </div>
        
        <div class="upgrades">
            <button onclick="buyBlock()">+1 блок (<span id="block-price">25</span>¢)</button>
            <button onclick="buyCardSlot()">+1 слотов (<span id="slot-price">5</span>¢)</button>
        </div>
        
        <div class="inventory">
            <div class="inventory-title">
                <span>Инвентарь</span>
                <span id="selected-card-name"></span>
            </div>
            <div class="cards-grid" id="inventory">
                <!-- Карты будут добавлены динамически -->
            </div>
        </div>
    </div>
    
    <div class="pack-opening" id="pack-opening" style="display: none;">
        <div class="pack-info" id="pack-info">Открываете маленькую пачку (осталось: 4 карт)</div>
        <div class="pack-card" id="pack-card">
            <!-- Карта будет добавлена динамически -->
        </div>
        <div class="continue-btn" onclick="continueOpening()">Продолжить</div>
    </div>
    
    <script>
        // Игровые данные
        let gameState = {
            money: 15,
            cards: [],
            placedCards: [],
            blocks: 3,
            maxCards: 15,
            blockPrice: 25,
            slotPrice: 5,
            lastPlayTime: Date.now()
        };
        
        let selectedCard = null;
        let currentPack = null;
        let cardsToOpen = 0;
        let cardsOpened = 0;
        let holdTimers = {};
        let tapStartTime = 0;
        let isSelling = false;

        // Цены продажи карт
        const sellPrices = {
            common: 1,
            rare: 3,
            epic: 10,
            legendary: 40,
            divine: 40000
        };
        
        // Карточные пачки
        const packs = {
            small: {
                price: 5,
                size: { min: 4, max: 6 },
                cards: [
                    { name: "Blockman Go!", chance: 50, rarity: "common", income: 0.01 },
                    { name: "Soul Knight", chance: 35, rarity: "common", income: 0.03 },
                    { name: "Baldi's Basic Classics", chance: 10.5, rarity: "rare", income: 0.07 },
                    { name: "Roblox", chance: 4, rarity: "rare", income: 0.1 },
                    { name: "Cookie Clicker", chance: 0.5, rarity: "epic", income: 0.8 }
                ]
            },
            big: {
                price: 50,
                size: { min: 4, max: 6 },
                cards: [
                    { name: "Baldi's Basic Classics", chance: 40, rarity: "rare", income: 0.07 },
                    { name: "Roblox", chance: 30, rarity: "rare", income: 0.1 },
                    { name: "Dead Cells", chance: 20, rarity: "rare", income: 0.3 },
                    { name: "Cookie Clicker", chance: 9, rarity: "epic", income: 0.8 },
                    { name: "Bandi", chance: 1, rarity: "epic", income: 1.2 }
                ]
            },
            Ultra: {
                price: 500,
                size: { min: 4, max: 6 },
                cards: [
                    { name: "Bandi", chance: 50, rarity: "epic", income: 1.2 },
                    { name: "Terraria", chance: 30, rarity: "epic", income: 2 },
                    { name: "FL Studio", chance: 17, rarity: "epic", income: 2.5 },
                    { name: "ULTRAKILL", chance: 2.55, rarity: "legendary", income: 3.25 },
                    { name: "GitHub", chance: 0.5, rarity: "legendary", income: 5 },
                    { name: "MINECRAFT", chance: 0.05, rarity: "divine", income: 100 }
                ]
            },
              Ultra: {
                price: 50000,
                size: { min: 5, max: 7 },
                cards: [
                     { name: "ULTRAKILL", chance: 40, rarity: "legendary", income: 3.25 },
                    { name: "Nothing", chance: 20, rarity: "legendary", income: 3.75 },
                    { name: "Ball", chance: 15, rarity: "legendary", income: 4.1 },
                    { name: "GitHub", chance: 10, rarity: "legendary", income: 5 },
                    { name: "GeometryDash", chance: 7, rarity: "legendary", income: 7 },
                    { name: "HollowKnight", chance: 6, rarity: "mythic", income: 15 },
                     { name: "Genshin", chance: 1.5, rarity: "mythic", income: 20 },
                     { name: "MINECRAFT", chance: 0.5, rarity: "divine", income: 100 }
                ]
            },
              OMEGA: {
                price: 4000000,
                size: { min: 2, max: 4 },
                cards: [
                    { name: "GeometryDash", chance: 70, rarity: "legendary", income: 7 },
                    { name: "Genshin", chance: 25, rarity: "mythic", income: 20 },
                   { name: "MINECRAFT", chance: 4.4, rarity: "divine", income: 100 },
                    { name: "FNAF", chance: 0.6, rarity: "divene", income: 300 }
                    
                ]
            },
              PPP: {
                price: 1000000000,
                size: { min: 1, max: 10 },
                cards: [
                      { name: "MINECRAFT", chance: 50, rarity: "divine", income: 100 },
                      { name: "MINECRAFT", chance: 35, rarity: "divine", income: 200 },
                      { name: "MINECRAFT", chance: 10, rarity: "secret", income: 1000 },
                      { name: "MINECRAFT", chance: 4.9, rarity: "secret", income: 2000 },
                      { name: "AI", chance: 0.1, rarity: "secret", income: 10000 }
                   
                ]
            },
        };
        
        // Инициализация игры
        function initGame() {
            loadGame();
            updateUI();
            renderBlocks();
            renderInventory();
            
            // Запуск пассивного дохода
            setInterval(passiveIncome, 1000);
            
            // Автосохранение каждые 30 секунд
            setInterval(saveGame, 30000);
            
            // Сохраняем при закрытии вкладки
            window.addEventListener('beforeunload', saveGame);
        }
        
        // Сохранение игры
        function saveGame() {
            gameState.lastPlayTime = Date.now();
            localStorage.setItem('cardGameSave', JSON.stringify(gameState));
        }
        
        // Загрузка игры
        function loadGame() {
            const saved = localStorage.getItem('cardGameSave');
            if (saved) {
                const parsed = JSON.parse(saved);
                
                // Рассчитываем офлайн-доход
                const now = Date.now();
                const offlineTime = now - parsed.lastPlayTime;
                const offlineSeconds = Math.floor(offlineTime / 1000);
                
                if (offlineSeconds > 0 && parsed.placedCards.length > 0) {
                    let offlineIncome = 0;
                    parsed.placedCards.forEach(card => {
                        if (card) offlineIncome += card.income * offlineSeconds;
                    });
                    
                    if (offlineIncome > 0) {
                        parsed.money += offlineIncome;
                        alert(`Вы получили ${offlineIncome.toFixed(2)}¢ за ${formatTime(offlineSeconds)} отсутствия!`);
                    }
                }
                
                gameState = parsed;
            }
        }
        
        // Форматирование времени
        function formatTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            return [
                hours > 0 ? `${hours}ч` : '',
                minutes > 0 ? `${minutes}м` : '',
                `${secs}с`
            ].filter(Boolean).join(' ');
        }
        
        // Обновление интерфейса
        function updateUI() {
            document.getElementById('money').textContent = gameState.money.toFixed(2);
            document.getElementById('total-cards').textContent = gameState.cards.length;
            document.getElementById('max-cards').textContent = gameState.maxCards;
            document.getElementById('block-price').textContent = gameState.blockPrice;
            document.getElementById('slot-price').textContent = gameState.slotPrice;
            
            // Обновление доступности кнопок
            document.getElementById('small-pack').disabled = gameState.money < packs.small.price || gameState.cards.length >= gameState.maxCards;
            document.getElementById('big-pack').disabled = gameState.money < packs.big.price || gameState.cards.length >= gameState.maxCards;
            document.getElementById('premium-pack').disabled = gameState.money < packs.premium.price || gameState.cards.length >= gameState.maxCards;
             document.getElementById('Ultra-pack').disabled = gameState.money < packs.premium.price || gameState.cards.length >= gameState.maxCards;
             document.getElementById('OMEGA-pack').disabled = gameState.money < packs.premium.price || gameState.cards.length >= gameState.maxCards;
             document.getElementById('PPP-pack').disabled = gameState.money < packs.premium.price || gameState.cards.length >= gameState.maxCards;
        }
        
        // Рендер блоков
        function renderBlocks() {
            const blocksContainer = document.getElementById('blocks');
            blocksContainer.innerHTML = '';
            
            // Инициализация массива placedCards, если нужно
            while (gameState.placedCards.length < gameState.blocks) {
                gameState.placedCards.push(null);
            }
            
            for (let i = 0; i < gameState.blocks; i++) {
                const block = document.createElement('div');
                block.className = 'block';
                block.textContent = i + 1;
                block.onclick = () => placeCard(i);
                
                // Если в этом блоке уже есть карта
                if (gameState.placedCards[i]) {
                    const card = gameState.placedCards[i];
                    const cardElement = document.createElement('div');
                    cardElement.className = `placed-card card ${card.rarity}`;
                    cardElement.onclick = (e) => {
                        e.stopPropagation();
                        removeCard(i);
                    };
                    
                    const nameElement = document.createElement('div');
                    nameElement.textContent = card.name;
                    nameElement.style.fontWeight = 'bold';
                    nameElement.style.fontSize = '12px';
                    
                    const incomeElement = document.createElement('div');
                    incomeElement.textContent = `+${card.income}¢/сек`;
                    incomeElement.style.fontSize = '10px';
                    
                    cardElement.appendChild(nameElement);
                    cardElement.appendChild(incomeElement);
                    block.appendChild(cardElement);
                }
                
                blocksContainer.appendChild(block);
            }
        }
        
        // Рендер инвентаря
        function renderInventory() {
            const inventory = document.getElementById('inventory');
            inventory.innerHTML = '';
            
            gameState.cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = `inventory-card card ${card.rarity}`;
                cardElement.textContent = card.name;
                cardElement.dataset.index = index;
                
                if (selectedCard === index) {
                    cardElement.classList.add('selected');
                }
                
                if (isSelling && index === sellingCardIndex) {
                    cardElement.classList.add('selling');
                }
                
                // Добавляем таймер для долгого нажатия
                const timer = document.createElement('div');
                timer.className = 'hold-timer';
                cardElement.appendChild(timer);
                
                // Обработчики событий
                cardElement.addEventListener('mousedown', () => startHold(index));
                cardElement.addEventListener('touchstart', () => startHold(index));
                cardElement.addEventListener('mouseup', () => endHold(index));
                cardElement.addEventListener('mouseleave', cancelHold);
                cardElement.addEventListener('touchend', () => endHold(index));
                
                inventory.appendChild(cardElement);
            });
        }
        
        // Начало удержания карты
        function startHold(index) {
            tapStartTime = Date.now();
            sellingCardIndex = index;
            
            // Запускаем таймер для продажи
            holdTimers[index] = setTimeout(() => {
                prepareToSell(index);
            }, 1000);
            
            // Анимация таймера
            const cardElement = document.querySelector(`.inventory-card[data-index="${index}"]`);
            if (cardElement) {
                const timer = cardElement.querySelector('.hold-timer');
                timer.style.width = '100%';
                timer.style.transition = 'width 1s linear';
            }
        }
        
        // Подготовка к продаже
        function prepareToSell(index) {
            isSelling = true;
            sellingCardIndex = index;
            renderInventory();
            
            // Продаем карту через небольшой промежуток для визуальной обратной связи
            setTimeout(() => {
                if (isSelling && sellingCardIndex === index) {
                    sellCard(index);
                }
            }, 300);
        }
        
        // Завершение удержания
        function endHold(index) {
            const tapDuration = Date.now() - tapStartTime;
            
            // Отменяем таймер продажи
            if (holdTimers[index]) {
                clearTimeout(holdTimers[index]);
                delete holdTimers[index];
            }
            
            // Сбрасываем анимацию таймера
            const cardElement = document.querySelector(`.inventory-card[data-index="${index}"]`);
            if (cardElement) {
                const timer = cardElement.querySelector('.hold-timer');
                timer.style.width = '0%';
                timer.style.transition = 'none';
            }
            
            // Если было короткое нажатие - выбираем карту
            if (tapDuration < 1000 && !isSelling) {
                selectCard(index);
            }
            
            // Сбрасываем состояние продажи
            isSelling = false;
            sellingCardIndex = null;
        }
        
        // Отмена удержания
        function cancelHold() {
            // Отменяем все таймеры
            Object.values(holdTimers).forEach(timer => clearTimeout(timer));
            holdTimers = {};
            
            // Сбрасываем состояние продажи
            isSelling = false;
            sellingCardIndex = null;
            renderInventory();
        }
        
        // Выбор карты
        function selectCard(index) {
            selectedCard = index;
            document.getElementById('selected-card-name').textContent = gameState.cards[index].name;
            renderInventory();
        }
        
        // Продажа карты
        function sellCard(index) {
            if (index >= 0 && index < gameState.cards.length) {
                const card = gameState.cards[index];
                const price = sellPrices[card.rarity] || 0;
                
                gameState.money += price;
                gameState.cards.splice(index, 1);
                
                if (selectedCard === index) selectedCard = null;
                else if (selectedCard > index) selectedCard--;
                
                updateUI();
                renderInventory();
                saveGame();
            }
        }
        
        // Размещение карты на блок
        function placeCard(blockIndex) {
            if (selectedCard === null) return;
            
            // Если в этом блоке уже есть карта, сначала убираем её
            if (gameState.placedCards[blockIndex]) {
                removeCard(blockIndex);
            }
            
            // Помещаем новую карту
            gameState.placedCards[blockIndex] = gameState.cards[selectedCard];
            gameState.cards.splice(selectedCard, 1);
            selectedCard = null;
            document.getElementById('selected-card-name').textContent = '';
            
            updateUI();
            renderBlocks();
            renderInventory();
            saveGame();
        }
        
        // Удаление карты из блока
        function removeCard(blockIndex) {
            if (gameState.placedCards[blockIndex] && gameState.cards.length < gameState.maxCards) {
                gameState.cards.push(gameState.placedCards[blockIndex]);
                gameState.placedCards[blockIndex] = null;
                
                updateUI();
                renderBlocks();
                renderInventory();
                saveGame();
            } else if (gameState.cards.length >= gameState.maxCards) {
                alert('Инвентарь полон! Купите больше слотов.');
            }
        }
        
        // Покупка пачки
        function buyPack(packType) {
            const pack = packs[packType];
            
            if (gameState.money < pack.price) {
                alert('Недостаточно денег!');
                return;
            }
            
            if (gameState.cards.length >= gameState.maxCards) {
                alert('Инвентарь полон! Купите больше слотов.');
                return;
            }
            
            gameState.money -= pack.price;
            updateUI();
            
            // Определяем количество карт в пачке
            const packSize = Math.floor(Math.random() * (pack.size.max - pack.size.min + 1)) + pack.size.min;
            
            // Начинаем открытие пачки
            currentPack = pack;
            cardsToOpen = packSize;
            cardsOpened = 0;
            
            document.getElementById('pack-info').textContent = `Открываете ${getPackName(packType)} пачку (осталось: ${packSize} карт)`;
            document.getElementById('pack-opening').style.display = 'flex';
            
            openNextCard();
        }
        
        // Получение названия пачки
        function getPackName(packType) {
            switch(packType) {
                case 'small': return 'маленькую';
                case 'big': return 'большую';
                case 'premium': return 'премиум';
                case 'Ultra': return 'Ультра';
                case 'OMEGA': return 'ОМЕГА';
                case 'PPP': return 'СЕКРЕТНАЯ';
                default: return '';
            }
        }
        
        // Открытие следующей карты
        function openNextCard() {
            if (cardsOpened >= cardsToOpen) {
                finishOpening();
                return;
            }
            
            const packCard = document.getElementById('pack-card');
            packCard.innerHTML = '';
            packCard.style.animation = 'none';
            void packCard.offsetWidth; // Trigger reflow
            packCard.style.animation = 'cardReveal 0.5s forwards';
            
            // Выбираем случайную карту согласно шансам
            const card = getRandomCard(currentPack.cards);
            
            const nameElement = document.createElement('div');
            nameElement.textContent = card.name;
            nameElement.style.fontWeight = 'bold';
            nameElement.style.fontSize = '18px';
            nameElement.style.marginBottom = '10px';
            
            const rarityElement = document.createElement('div');
            rarityElement.textContent = getRarityName(card.rarity);
            rarityElement.style.fontSize = '14px';
            rarityElement.style.marginBottom = '10px';
            
            const incomeElement = document.createElement('div');
            incomeElement.textContent = `Доход: +${card.income}¢/сек`;
            incomeElement.style.fontSize = '14px';
            
            packCard.className = `pack-card card ${card.rarity}`;
            packCard.appendChild(nameElement);
            packCard.appendChild(rarityElement);
            packCard.appendChild(incomeElement);
            
            // Добавляем карту в инвентарь
            gameState.cards.push(card);
            cardsOpened++;
            
            document.getElementById('pack-info').textContent = `Открываете ${getPackName(getPackType(currentPack))} пачку (осталось: ${cardsToOpen - cardsOpened} карт)`;
            updateUI();
            saveGame();
        }
        
        // Получение типа пачки
        function getPackType(pack) {
            for (const type in packs) {
                if (packs[type] === pack) return type;
            }
            return null;
        }
        
        // Получение названия редкости
        function getRarityName(rarity) {
            switch(rarity) {
                case 'common': return 'Обычная';
                case 'rare': return 'Редкая';
                case 'epic': return 'Эпическая';
                case 'legendary': return 'Легендарная';
                case 'mythic': return 'мифическая';
                case 'secret': return 'SECRET';
                case 'divine': return 'БОЖЕСТВЕННАЯ';
                default: return '';
            }
        }
        
        // Завершение открытия пачки
        function finishOpening() {
            document.getElementById('pack-opening').style.display = 'none';
            renderInventory();
        }
        
        // Продолжить открытие
        function continueOpening() {
            openNextCard();
        }
        
        // Получение случайной карты
        function getRandomCard(cardPool) {
            const totalChance = cardPool.reduce((sum, card) => sum + card.chance, 0);
            let random = Math.random() * totalChance;
            
            for (const card of cardPool) {
                if (random < card.chance) {
                    return {...card}; // Возвращаем копию карты
                }
                random -= card.chance;
            }
            
            return {...cardPool[0]}; // На всякий случай
        }
        
        // Покупка блока
        function buyBlock() {
            if (gameState.money < gameState.blockPrice) {
                alert('Недостаточно денег!');
                return;
            }
            
            gameState.money -= gameState.blockPrice;
            gameState.blocks++;
            gameState.placedCards.push(null); // Добавляем слот для новой карты
            gameState.blockPrice = Math.floor(gameState.blockPrice * 1.5); // Увеличиваем цену на 50%
            
            updateUI();
            renderBlocks();
            saveGame();
        }
        
        // Покупка слота
        function buyCardSlot() {
            if (gameState.money < gameState.slotPrice) {
                alert('Недостаточно денег!');
                return;
            }
            
            gameState.money -= gameState.slotPrice;
            gameState.maxCards++;
            gameState.slotPrice = Math.floor(gameState.slotPrice * 1.05); // Увеличиваем цену на 50%
            
            updateUI();
            saveGame();
        }
        
        // Пассивный доход
        function passiveIncome() {
            let income = 0;
            
            // Подсчитываем доход со всех размещенных карт
            gameState.placedCards.forEach(card => {
                if (card) income += card.income;
            });
            
            if (income > 0) {
                gameState.money += income;
                updateUI();
                saveGame();
            }
        }
        
        // Запуск игры при загрузке
        window.onload = initGame;
    </script>
</body>
</html>
